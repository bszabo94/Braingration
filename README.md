# Braingration
## An interactive map to visualize migration of scientists

### Datasets
#### Scientists Dataset

For this project, the dataset is generated by fetching core data from [DBpedia](https://wiki.dbpedia.org/). DBpedia is a database, that stores the data of Wikipedia in a structured form as graphs. The project aims to collect data about scientists and the locations they birth, lived and worked in during their lifetime to visualize scientific immigration and intellectual hotspots. Using DBpedia as a base of data guarantees the constant updates in our dataset.

Once fetched, the dataset is merged and properly preprocessed by the preprocessing scripts in the 'dataset' directory. Preprocessed data contains some metadata, such as the number of scientists, locations and a list containing all scientist in the following form:

```json
{
      "uri": "http://dbpedia.org/resource/Albert_Einstein",
      "birthplace": {
        "uri": "http://dbpedia.org/resource/Ulm",
        "lat": 48.4,
        "long": 9.98333,
        "score": 70300
      },
      "places": [
        {
          "uri": "http://dbpedia.org/resource/University_of_Bern",
          "lat": 46.9505,
          "long": 7.43811,
          "score": 0
        },
        {
          "uri": "http://dbpedia.org/resource/Austria-Hungary",
          "lat": 48.2,
          "long": 16.35,
          "score": 202
        },
        {
          "uri": "http://dbpedia.org/resource/Berlin",
          "lat": 52.5167,
          "long": 13.3833,
          "score": 70400
        },
        {
          "uri": "http://dbpedia.org/resource/Columbia_University",
          "lat": 40.8075,
          "long": -73.9619,
          "score": 0
        }
      ],
      "birthyear": 1879,
      "deathyear": 1955
    }
```

Most locations are scored in order to be sorted. This sorting is required for the birthplaces, as for several scientists multiple birthplices are available. These are however, describing the same location on different scopes (e.g. country, county, city) and it is desirable to have the most specific one for the visulaization.

This dataset can be generated by running the [*dataFetcher.js*](https://github.com/bszabo94/Braingration/blob/master/dataset/dataFetcher.js) script in Node.js .

#### Geojson Dataset

The dataset containing the geological informations can be downloaded from [geojson-maps.ash.ms](https://geojson-maps.ash.ms/). This dataset describes polygons in GeoJSON format and some metadata for the various countries of the world. This data is used to draw the countries on an SVG image using [D3](https://d3js.org/) library. 

#### Final Dataset

The final dataset is generated using the [*countryGrouper.js*](https://github.com/bszabo94/Braingration/blob/master/dataset/countryGrouper.js) script. Although D3 has the relevant [method](https://github.com/d3/d3-geo#geoContains) to determine if a certain point, described by a pair longitude-latitude coordinates is contained by a GeoJSON polygon, this check must happen while the GeoJSON data is in its pure, GeoJSON format. Therefore the final dataset is created by merging the two core datasets, where the points and edges are labelled by their relevant countries, allowing them to be filtered by this condition later.

### Creating the Map
#### Creating the Elements
The map is created as an SVG image, drawn by the D3 library mentioned earlier. The map is generated using the following steps:

1. For each given country, the relevant parts are drawn
    1. The country's polygon is drawn
    2. Birthplaces in the country are drawn (the more places the person visited, the larger the marker for the birthplace is)
    3. Locations in the country are drawn
    4. Edges of the country are grouped for further purpose
2. Once all country was drawn, all the edges are drawn as well

All edges, locations and birthplaces are grouped within the SVG element in order to minimuze DOM modifications during user interaction and reach the best possible performance.

#### Creating the Coloring
The coloring is calculated during the drawing of the map. For all countries, all the tones of the other countries are fixed durign the initial map drawing. The red and green tones stand for emigration and immigration from a country to the selected country. The brigther the color, the higher the rate of the given migration. The rates are distributed on the given scale using the natural logarithm to provide better visibility. Yellow countries stand for an equal number of migration on both directions.